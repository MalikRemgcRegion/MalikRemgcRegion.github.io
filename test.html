<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>malikremgcregion.github.io</title>
	<meta name="description" content="MalikRemgcRegion brings an insight into regional account hoppers">
	<meta property="og:type" content="website">
	<meta property="og:title" content="malikremgcregion.github.io">
	<meta property="og:description" content="Showing you regional account hoppers from malikremgcregion.github.io">
	<meta property="og:url" content="https://malikremgcregion.github.io/">
	<meta property="og:image" content="https://malikremgcregion.github.io/assets/colored_body_top2.png">
	<meta name="twitter:site" content="@malikremgcregion">
	<meta name="twitter:image" content="https://malikremgcregion.github.io/assets/colored_body_top2.png">
	<meta name="twitter:card" content="summary_large_image">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">  
</head>
<!-- 
https://apexcharts.com/docs/chart-types/treemap-chart/ 
look into the numbers of accounts in each region, then look into which region has the highest games count.
look into the potential loss by talling up the app diffs to each region from each account in that region. 
(confirmed regional account changers only). 
we can then make an estimation of the loss the devs are having.


https://preview.keenthemes.com/html/metronic/docs/charts/amcharts/maps

-->
<body>

	<!-- put into a nav file -->
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
	  <ul class="navbar-nav">
		<li class="nav-item active">
		  <a class="nav-link" href="https://malikremgcregion.github.io/">Home</a>
		</li>
		<li class="nav-item">
		  <a class="nav-link" href="https://github.com/MalikRemgcRegion/MalikRemgcRegion.github.io">Github</a>
		</li>
		<li class="nav-item">
		  <a class="nav-link" href="https://discord.gg/4X96kRjety">Discord</a>
		</li>
		<div class="dropdown">
		  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			Ladders
		  </button>
		  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
			<a class="dropdown-item" href="./shame.html">Shame Ladder</a>
			<a class="dropdown-item" href="./suspects.html">Suspects Ladder</a>
			<a class="dropdown-item" href="./ladder.html">RRGC Ladder</a>
		  </div>
		</div>
		<li class="nav-item">
		  <a class="nav-link" href="https://github.com/MalikRemgcRegion/MalikRemgcRegion.github.io/raw/main/rrgc.user.js">RRGC Userscript</a>
		</li>
		<li class="nav-item">
		  <a class="nav-link" href="./about.html">About</a>
		</li>
	  </ul>
	</nav>
	
	<div id="main_data" class="container text-light mt-3">
		<div class="row">
			<div class="col-sm-9">

				<div class="container">
					<div id="svgMap"></div>
				</div>
				
				<div class="container">
					<div id="chartdiv"></div>
				</div>
				
			</div>
			
			<div class="col-sm-3">
	
			</div>
		</div>
		
		<!-- <div class="chartContainer" style="height: 300px; width: 100%;"></div> -->
	</div>
	
	
	
	<!-- 
	https://www.amcharts.com/demos/map-with-animated-bubbles/
	-->
	
	<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
	<script src="https://cdn.amcharts.com/lib/5/map.js"></script>
	<script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
	<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
	
	
	<style>
	body {
	  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
	}

	#chartdiv {
	  width: 100%;
	  height: 600px
	}
	</style>
	
	<!-- 
	https://stephanwagner.me/create-world-map-charts-with-svgmap 
	-->
	<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/StephanWagner/svgMap@v2.7.2/dist/svgMap.min.js"></script>
	<link href="https://cdn.jsdelivr.net/gh/StephanWagner/svgMap@v2.7.2/dist/svgMap.min.css" rel="stylesheet">

	
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script>$('body').css('background-image', 'url("./assets/colored_body_top2.png")');</script>
	<!-- jQuery Datatable js --><script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
	<!-- Bootstrap Datatable js --><script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
	
	<script>
	new svgMap({
	  targetElementID: 'svgMap',
	  data: {
		data: {
		  abcdef: {
			name: 'Account game count',
			format: '{0}',
			thousandSeparator: ',',
			thresholdMax: 0,
			thresholdMin: 0
		  },
		  ghijkl: {
			name: 'Account changed to this region:',
			format: '{0}'
		  }
		},
		applyData: 'abcdef',
		values: {
		  CN: {abcdef: 0, ghijkl: 1666372433},
		  AZ: {abcdef: 25000, ghijkl: 1666372433},
		  AR: {abcdef: 50000, ghijkl: 1666372433},
		  TR: {abcdef: 50000, ghijkl: 1666372433},
		  AR: {abcdef: 50000, ghijkl: 1666372433},
		  CN: {abcdef: 50000, ghijkl: 1666372433}
		  // ...
		}
	  }
	});
	</script>
	
	<script>
	 /**
	 * ---------------------------------------
	 * This demo was created using amCharts 5.
	 * 
	 * For more information visit:
	 * https://www.amcharts.com/
	 * 
	 * Documentation is available at:
	 * https://www.amcharts.com/docs/v5/
	 * ---------------------------------------
	 */
	 
	 /*
	 jQuery.extend({
		getValues: function(url) {
			var result = null;
			$.ajax({
				url: url,
				type: 'get',
				dataType: 'text',
				async: false,
				success: function(data) {
					result = data;
				}
			});
		   return result;
		}
	});
	
	
	var _db = $.getValues("./db/db.json");
	var j_db = JSON.parse( _db );
	*/
	 
	 
	 var _steamid = "76561198355625888";
			
	$.ajax({
	   url: "https://raw.githubusercontent.com/MalikRemgcRegion/RemGC_DB/main/db/db.json",
		type:"get",
		dataType: 'text',  
		error: function(data){
		//debugger;
		  //alert('err');
		},
		success:function(data) {
			var data = JSON.parse( data );
			
			var profile_id, profile_time_stamp, profile_region;
			
			/*we need to handle the _steamid data. ideally we want to get the below json output into a variable data.
			var data = [
			  {
				id: "US",
				value: 0
			  }, {
				id: "GB",
				value: 1
			  }
			];
			
			//getting the data to create the json. profile_region
			var arr = [
				"CN",
				"AZ",
				"AR",
				"TR",
				"AR",
				"CN"
			];
			
			//this is for the id 
			let unique = [...new Set(arr)];
			console.log(unique); // unique is ['CN', 'AZ', 'AR', 'TR']
			
			//this is for the value, counting how many times the account has changed to a specific region.
			const counts = {};
			for (const num of arr) {
			  counts[num] = counts[num] ? counts[num] + 1 : 1;
			}
			console.log(counts); // count is {CN: 2, AZ: 1, AR: 2, TR: 1}
			
			//build the json data for the map.
			var data = [];
			for (let i = 0; i < unique.length; i++) {
                data.push({ id: unique[i], value: counts[unique[i]] });
			}
			console.log(JSON.stringify(data)); // data is [{"id":"CN","value":2},{"id":"AZ","value":1},{"id":"AR","value":2},{"id":"TR","value":1}]
			*/
			
			$.each(data, function (i) {				
				if(data[i].id === _steamid ){
					
					profile_id = data[i].id;
					profile_time_stamp = data[i].time_stamp; 
					profile_region = data[i].region;
					profile_game_count = data[i].game_count;
				
				}
			});
			
			console.log(profile_id + "\n" + profile_time_stamp + "\n" + profile_region + "\n" + profile_game_count);
			
			//this is for the id 
			let unique = [...new Set(profile_region)];
			console.log(unique); // unique is ['CN', 'AZ', 'AR', 'TR']
			
			//this is for the value, counting how many times the account has changed to a specific region.
			const counts = {};
			for (const num of profile_region) {
			  counts[num] = counts[num] ? counts[num] + 1 : 1;
			}
			console.log(counts); // count is {CN: 2, AZ: 1, AR: 2, TR: 1}
			
			//build the json data for the map.
			var data = [];
			for (let i = 0; i < unique.length; i++) {
				data.push({ id: unique[i], value: counts[unique[i]] });
			}
			console.log(JSON.stringify(data)); // data is [{"id":"CN","value":2},{"id":"AZ","value":1},{"id":"AR","value":2},{"id":"TR","value":1}]
			 
			 
			 
			/*
			var data = [
			  {
				id: "US",
				value: 0
			  }, {
				id: "GB",
				value: 1
			  }, {
				id: "CN",
				value: 2
			  }, {
				id: "IN",
				value: 1
			  }, {
				id: "AU",
				value: 1
			  }, {
				id: "CA",
				value: 1
			  }, {
				id: "BR",
				value: 1
			  }, {
				id: "ZA",
				value: 1
			  }
			];
			*/

			var root = am5.Root.new("chartdiv");
			root.setThemes([am5themes_Animated.new(root)]);

			var chart = root.container.children.push(am5map.MapChart.new(root, {}));

			var polygonSeries = chart.series.push(
			  am5map.MapPolygonSeries.new(root, {
				geoJSON: am5geodata_worldLow,
				exclude: ["AQ"]
			  })
			);

			var bubbleSeries = chart.series.push(
			  am5map.MapPointSeries.new(root, {
				valueField: "value",
				calculateAggregates: true,
				polygonIdField: "id"
			  })
			);

			var circleTemplate = am5.Template.new({});

			bubbleSeries.bullets.push(function(root, series, dataItem) {
			  var container = am5.Container.new(root, {});

			  var circle = container.children.push(
				am5.Circle.new(root, {
				  radius: 20,
				  fillOpacity: 0.7,
				  fill: am5.color(0xff0000),
				  cursorOverStyle: "pointer",
				  tooltipText: `{name}: [bold]{value}[/]`
				}, circleTemplate)
			  );

			  var countryLabel = container.children.push(
				am5.Label.new(root, {
				  text: "", //text: "{name}", leave this blank?
				  paddingLeft: 5,
				  populateText: true,
				  fontWeight: "bold",
				  fontSize: 13,
				  centerY: am5.p50
				})
			  );

			  circle.on("radius", function(radius) {
				countryLabel.set("x", radius);
			  })

			  return am5.Bullet.new(root, {
				sprite: container,
				dynamic: true
			  });
			});

			bubbleSeries.bullets.push(function(root, series, dataItem) {
			  return am5.Bullet.new(root, {
				sprite: am5.Label.new(root, {
				  text: "{value.formatNumber('#.')}",
				  fill: am5.color(0xffffff),
				  populateText: true,
				  centerX: am5.p50,
				  centerY: am5.p50,
				  textAlign: "center"
				}),
				dynamic: true
			  });
			});



			// minValue and maxValue must be set for the animations to work
			bubbleSeries.set("heatRules", [
			  {
				target: circleTemplate,
				dataField: "value",
				min: 10,
				max: 50,
				minValue: 0,
				maxValue: 100,
				key: "radius"
			  }
			]);

			bubbleSeries.data.setAll(data);

			updateData();
			setInterval(function() {
			  updateData();
			}, 2000)

			function updateData() {
			  for (var i = 0; i < bubbleSeries.dataItems.length; i++) {
				bubbleSeries.data.setIndex(i, { value: data[i].value, id: data[i].id, name: data[i].id })
			  }
			}
			
			
			
		}
	});
	
	
	</script>
	
</body>
</html>
